
This plan addresses the missing piece of information regarding the constraint on adjacent rows and incorporates edge cases.

===END PLAN===
