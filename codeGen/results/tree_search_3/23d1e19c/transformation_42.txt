dp[i] = min(dp[j] + 1 for j in range(min(p), i+1) if has_edge(j, i))
