
Here's an implementation of the improved plan in Python:

