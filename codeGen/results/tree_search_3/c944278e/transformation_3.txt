
Please note that this updated plan still needs to be refined and might not cover all edge cases. Further analysis and refinement are necessary to ensure an accurate and efficient solution.
