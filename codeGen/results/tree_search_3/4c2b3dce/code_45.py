
This approach ensures that we don't miss any substrings, even those at the start or end of the string.

Here's a Python implementation based on your plan:

