Consider dp[i] to be the maximum score obtained by considering all appearances of number i in the sequence, and deciding whether to take or not take number i and its consequences.
Fill the dp table bottom-up, starting with the smallest element and moving up to the largest, since each dp[i] depends on dp[i-1].
