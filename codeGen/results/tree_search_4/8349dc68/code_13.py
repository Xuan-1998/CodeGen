
Here's a Python implementation that wraps your plan:

