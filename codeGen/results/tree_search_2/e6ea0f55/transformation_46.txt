The top-down approach with memoization could be used to solve this problem by defining a function that takes the current index and the maximum sum as arguments, and returns the maximum sum of subsequences ending at the current index.
Define the state expression: dp[i] = {sum, last_index}, where dp[i] is a tuple containing the maximum sum and the last index of a subsequence ending at index i.
dp[i][0] = max(dp[j][0] + nums[i], dp[j][1] - j + k, 0) for j in range(max(0, i-k), i+1)
Create a function memoize(f) that takes another function f and returns a new function g that memoizes the results of f.
