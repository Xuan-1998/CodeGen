dp = {i: {j: False for j in range(K+1)} for i in range(N+1)}
for i in range(1, N+1):
    for j in range(min(i//K, K)+1):
        if all(A[k-1]-M <= A[m] <= A[k-1]+M for m in range(max(0, k-j), k)):
            dp[i][j] = dp[k-j][j-1]
        else:
            dp[i][j] = False
