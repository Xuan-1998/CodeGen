===BEGIN PLAN===
Use tabulation to fill a 2D table where each cell represents the beauty value of a subarray ending at that index. The state transition relationship is defined by considering the minimum prime divisor of the last element in the subarray and whether it's a good or bad prime.
Fill the table from left to right, top to bottom, using previously computed values.

Consider two possibilities: either the last element in the subarray is a good prime or not.

The state transition function can be defined as follows:
- If the minimum prime divisor of the last element in the subarray is a good prime, update the beauty value by considering this fact.
- If the minimum prime divisor of the last element in the subarray is a bad prime, reduce the beauty value accordingly.

Utilize a separate table to store intermediate results, allowing you to avoid redundant computations when filling the main 2D table.

To fill the table, iterate over each cell from left to right and top to bottom. For each cell, compute its value based on the previously computed values and update the table accordingly.

===END PLAN===
