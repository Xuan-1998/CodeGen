===BEGIN PLAN===
Use tabulation to fill a 2D table where each cell represents the beauty value of a subarray ending at that index. The state transition relationship is defined by considering the minimum prime divisor of the last element in the subarray and whether it's a good or bad prime. Fill the table from left to right, top to bottom, using previously computed values.

Consider two possibilities: either the last element in the subarray is a good prime or not.
Transition Relationship:
    1. If the last element is a good prime:
        - Calculate the beauty value for this subarray based on the minimum prime divisor of the last element and whether it's a good or bad prime.
        - Update the table with the calculated beauty value.
    2. If the last element is not a good prime:
        - Calculate the beauty value for this subarray by considering the maximum beauty value for the subarray ending at the second-to-last element.
        - Update the table with the calculated beauty value.

Use dynamic programming to fill a 1D array where each cell represents the maximum beauty value for subarrays up to that length.

===END PLAN===
