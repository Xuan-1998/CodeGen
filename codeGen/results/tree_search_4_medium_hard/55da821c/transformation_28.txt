This plan should work correctly and handle edge cases. It also includes all necessary steps for the problem.
