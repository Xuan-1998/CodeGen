===BEGIN PLAN===
Consider the state of the current number as a tuple of its length and value, and use memoization to store the results for each operation.

state = (n, remain)
where n is the length of the current number
remain is a list of the remaining digits in val that have not been operated yet

Base case: when n is a single digit

Transition relationship:
- For each digit d in remain:
  - Apply the operation to the current value of the number by replacing d with d+1 (if d!=9)
  - Update the state with the new length and value
- Update the memoization dictionary with the result for the current state

Use a dictionary to store the results for each operation and update it accordingly.

===END PLAN===
