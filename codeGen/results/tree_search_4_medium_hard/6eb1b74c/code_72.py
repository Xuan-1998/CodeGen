Here's a Python implementation based on your plan:
