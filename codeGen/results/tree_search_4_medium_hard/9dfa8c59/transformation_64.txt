===BEGIN PLAN===
Dynamic programming with a recursive function that checks if a number is prime and has k_perms permutations, updating the results as needed:
    1. Define a base case: n_max is less than or equal to 2, as prime numbers below this value have no more than one permutation.
    2. Develop an iterative approach by iterating from n_max downwards, checking each number's primality and permutation count, and updating the results as needed.
    3. Create a dynamic programming table where each cell represents the prime numbers with k_perms permutations up to that index.

===END PLAN===
