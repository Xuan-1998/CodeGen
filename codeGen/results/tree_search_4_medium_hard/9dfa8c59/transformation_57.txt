===BEGIN PLAN===
To solve this problem, we can use dynamic programming with memoization. Here's an updated plan:

