"{\"statement\": \"Task: Given a book with $n$ chapters, where each chapter has a list of required chapters that must be understood before it, determine the minimum number of times the book needs to be read to understand all the chapters. If it's impossible to understand the whole book, output -1.\\n\\nInput: The input consists of multiple test cases. The first line of each test case contains an integer $n$ ($1 \\\\le n \\\\le 2\\\\cdot10^5$), representing the number of chapters in the book. The following $n$ lines describe the required chapters for each chapter. Each line starts with an integer $k_i$ ($0 \\\\le k_i \\\\le n-1$), representing the number of chapters required to understand chapter $i$. This is followed by $k_i$ integers $a_{i,1}, a_{i,2}, \\\\dots, a_{i, k_i}$ ($1 \\\\le a_{i, j} \\\\le n, a_{i, j} \\\\ne i, a_{i, j} \\\\ne a_{i, l}$ for $j \\\\ne l$), representing the chapters that must be understood before chapter $i$. Input is taken from standard input.\\n\\nOutput: For each test case, output a single integer representing the minimum number of times the book needs to be read to understand all the chapters. If it's impossible to understand the whole book, output -1. Output is printed to standard output.\\n\\nConstraints: The sum of $n$ and sum of $k_i$ over all test cases do not exceed $2\\\\cdot10^5$.\", \"editorial\": \"\", \"tag\": \"['Graph algorithms', 'Sorting', 'Implementation', 'Complete search', 'Dynamic programming', 'Data structures']\", \"difficulties\": \"MEDIUM_HARD\", \"source\": \"codeforces\", \"url\": \"https://codeforces.com/problemset/problem/1572/A\", \"sample_test_cases\": [{\"input\": \"5\\n4\\n1 2\\n0\\n2 1 4\\n1 2\\n5\\n1 5\\n1 1\\n1 2\\n1 3\\n1 4\\n5\\n0\\n0\\n2 1 2\\n1 2\\n2 2 1\\n4\\n2 2 3\\n0\\n0\\n2 3 2\\n5\\n1 2\\n1 3\\n1 4\\n1 5\\n0\\n\", \"output\": \"2\\n-1\\n1\\n2\\n5\\n\"}]}"